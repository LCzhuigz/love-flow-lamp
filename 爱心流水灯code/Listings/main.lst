C51 COMPILER V9.60.7.0   MAIN                                                              04/10/2025 14:14:19 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\software\keil\core\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Li
                    -stings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <REGX52.H>
   2          
   3          typedef unsigned char uchar;
   4          typedef unsigned int uint;
   5          
   6          void Delay_ms(unsigned int xms);
   7          
   8          void clock_wise(uint x);
   9          void anticlock_wise(uint x);
  10          void all_dance(void);
  11          void two_flanks(uint x);
  12          void breath_effect(void);
  13          void cross_flash(void);
  14          void random_flash(void);
  15          void heartbeat(void);
  16          void wave_effect(void);
  17          void marquee(void);
  18          void gradient_blink(void);
  19          void spiral(void);
  20          void rainbow_effect(void);
  21          void flash_center(void);
  22          
  23          
  24          void main()
  25          {
  26   1          while(1)
  27   1          {   
  28   2          uint i;
  29   2              Delay_ms(1000);
  30   2              for (i = 250; i > 0; i -= 50)
  31   2              {
  32   3                  clock_wise(i);
  33   3              }
  34   2       
  35   2          for (i = 250; i > 0; i -= 50)
  36   2              {
  37   3                  anticlock_wise(i);
  38   3              }
  39   2          Delay_ms(60);
  40   2          clock_wise(20);
  41   2          Delay_ms(60);
  42   2          anticlock_wise(20);
  43   2              Delay_ms(60);
  44   2              two_flanks(10);
  45   2              Delay_ms(60);
  46   2              all_dance();
  47   2              Delay_ms(60);
  48   2              breath_effect();    // 新增呼吸效果
  49   2          Delay_ms(60);
  50   2              cross_flash();      // 新增交叉闪烁
  51   2          Delay_ms(60);
  52   2              random_flash();     // 新增随机闪烁
  53   2          Delay_ms(60);
  54   2              heartbeat();        // 新增心跳效果
C51 COMPILER V9.60.7.0   MAIN                                                              04/10/2025 14:14:19 PAGE 2   

  55   2          wave_effect();      // 新增波浪效果
  56   2              Delay_ms(60);
  57   2              marquee();          // 新增跑马灯
  58   2              Delay_ms(60);
  59   2              gradient_blink();   // 新增渐变闪烁
  60   2              Delay_ms(60);
  61   2              spiral();           // 新增螺旋闪烁
  62   2              Delay_ms(60);
  63   2              rainbow_effect();   // 新增彩虹渐变效果
  64   2              Delay_ms(60);
  65   2              flash_center(); 
  66   2              
  67   2          }
  68   1      }
  69          
  70          //12m晶振频率，毫秒级延时
  71          void Delay_ms(uint xms)
  72          {
  73   1        uchar i, j;
  74   1        while(xms)
  75   1        {
  76   2          i = 2;
  77   2          j = 239;
  78   2          do
  79   2          {
  80   3            while (--j);
  81   3          } while (--i);
  82   2          xms--;
  83   2        }
  84   1      }
  85          
  86          //全体led闪烁
  87          void all_dance(void){
  88   1          P0=0x00;P1=0x00;P2=0x00;P3=0x00;
  89   1          Delay_ms(600);
  90   1          P0=0xff;P1=0xff;P2=0xff;P3=0xff;
  91   1          Delay_ms(600);
  92   1      }
  93          //顺时针流水灯
  94          void clock_wise(uint x){
  95   1          P1=0x7F;Delay_ms(x);P1=0xBF;Delay_ms(x);P1=0xDF;Delay_ms(x);P1=0xEF;Delay_ms(x);
  96   1          P1=0xF7;Delay_ms(x);P1=0xFB;Delay_ms(x);P1=0xFD;Delay_ms(x);P1=0xFE;Delay_ms(x);
  97   1          P1=0xFF;Delay_ms(x);
  98   1          
  99   1          P0=0xFE;Delay_ms(x);P0=0xFD;Delay_ms(x);P0=0xFB;Delay_ms(x);P0=0xF7;Delay_ms(x);
 100   1          P0=0xEF;Delay_ms(x);P0=0xDF;Delay_ms(x);P0=0xBF;Delay_ms(x);P0=0x7F;Delay_ms(x);
 101   1          P0=0xFF;Delay_ms(x);
 102   1          
 103   1          P2=0x7F;Delay_ms(x);P2=0xBF;Delay_ms(x);P2=0xDF;Delay_ms(x);P2=0xEF;Delay_ms(x);
 104   1          P2=0xF7;Delay_ms(x);P2=0xFB;Delay_ms(x);P2=0xFD;Delay_ms(x);P2=0xFE;Delay_ms(x);
 105   1          P2=0xFF;Delay_ms(x);
 106   1          
 107   1          P3=0x7f;Delay_ms(x);P3=0xBF;Delay_ms(x);P3=0xDF;Delay_ms(x);P3=0xEF;Delay_ms(x);
 108   1          P3=0xF7;Delay_ms(x);P3=0xFB;Delay_ms(x);P3=0xFD;Delay_ms(x);P3=0xFE;Delay_ms(x);
 109   1          P3=0xFF;Delay_ms(x);
 110   1      }
 111          //逆时针流水灯
 112          void anticlock_wise(uint x){
 113   1          P3=0xFE;Delay_ms(x);P3=0xFD;Delay_ms(x);P3=0xFB;Delay_ms(x);P3=0xF7;Delay_ms(x);
 114   1          P3=0xEF;Delay_ms(x);P3=0xDF;Delay_ms(x);P3=0xBF;Delay_ms(x);P3=0x7F;Delay_ms(x);
 115   1          P3=0xFF;Delay_ms(x);
 116   1          
C51 COMPILER V9.60.7.0   MAIN                                                              04/10/2025 14:14:19 PAGE 3   

 117   1          P2=0xFE;Delay_ms(x);P2=0xFD;Delay_ms(x);P2=0xFB;Delay_ms(x);P2=0xF7;Delay_ms(x);
 118   1          P2=0xEF;Delay_ms(x);P2=0xDF;Delay_ms(x);P2=0xBF;Delay_ms(x);P2=0x7F;Delay_ms(x);
 119   1          P2=0xFF;Delay_ms(x);
 120   1          
 121   1          P0=0x7F;Delay_ms(x);P0=0xBF;Delay_ms(x);P0=0xDF;Delay_ms(x);P0=0xEF;Delay_ms(x);
 122   1          P0=0xF7;Delay_ms(x);P0=0xFB;Delay_ms(x);P0=0xFD;Delay_ms(x);P0=0xFE;Delay_ms(x);
 123   1          P0=0xFF;Delay_ms(x);
 124   1          
 125   1          P1=0xFE;Delay_ms(x);P1=0xFD;Delay_ms(x);P1=0xFB;Delay_ms(x);P1=0xF7;Delay_ms(x);
 126   1          P1=0xEF;Delay_ms(x);P1=0xDF;Delay_ms(x);P1=0xBF;Delay_ms(x);P1=0x7F;Delay_ms(x);
 127   1          P1=0xFF;Delay_ms(x);
 128   1      }
 129          //两侧同时流水
 130          void two_flanks(uint x){
 131   1        P1=0x7F;P3=0xFE;Delay_ms(x);P1=0xBF;P3=0xFD;Delay_ms(x);P1=0xDF;P3=0xFB;Delay_ms(x);P1=0xEF;P3=0xF7;Delay
             -_ms(x);
 132   1        P1=0xF7;P3=0xEF;Delay_ms(x);P1=0xFB;P3=0xDF;Delay_ms(x);P1=0xFD;P3=0xBF;Delay_ms(x);P1=0xFE;P3=0x7F;Delay
             -_ms(x);
 133   1        P1=0xFF;P3=0xFF;Delay_ms(x);
 134   1      
 135   1          P0=0xFD;P2=0xFD;Delay_ms(x);P0=0xFE;P2=0xFE;Delay_ms(x);P0=0xFB;P2=0xFB;Delay_ms(x);P0=0xF7;P2=0xF7;De
             -lay_ms(x);
 136   1        P0=0xEF;P2=0xEF;Delay_ms(x);P0=0xDF;P2=0xDF;Delay_ms(x);P0=0xBF;P2=0xBF;Delay_ms(x);P0=0x7F;P2=0x7F;Delay
             -_ms(x);
 137   1        P0=0xFF;P2=0xFF;Delay_ms(x);
 138   1      }
 139          
 140          //呼吸灯效果（所有LED渐变亮度）
 141          void breath_effect(void) {
 142   1        uchar i;
 143   1          for(i=0; i<5; i++) {
 144   2              P0=0xFF<<i; P1=0xFF<<i; P2=0xFF<<i; P3=0xFF<<i;
 145   2              Delay_ms(80);
 146   2          }
 147   1          for(i=5; i>0; i--) {
 148   2              P0=0xFF<<i; P1=0xFF<<i; P2=0xFF<<i; P3=0xFF<<i;
 149   2              Delay_ms(80);
 150   2          }
 151   1      }
 152          
 153          //随机闪烁（随机位置LED闪烁）
 154          void random_flash(void) {
 155   1        uchar i;
 156   1          for(i=0; i<8; i++) {
 157   2          P0 = ~(0x01 << (i%8)); 
 158   2          P1 = ~(0x01 << ((i+2)%8));
 159   2          P2 = ~(0x01 << ((i+4)%8));
 160   2          P3 = ~(0x01 << ((i+6)%8));
 161   2          Delay_ms(80);
 162   2          }
 163   1      }
 164          
 165          //交叉闪烁（左右交替）
 166          void cross_flash(void) {
 167   1        uchar i;
 168   1          for(i=0; i<4; i++) {
 169   2              P0=0xAA; P1=0xAA; P2=0x55; P3=0x55;  // 左半亮右半灭
 170   2              Delay_ms(200);
 171   2              P0=0x55; P1=0x55; P2=0xAA; P3=0xAA;  // 右半亮左半灭
 172   2              Delay_ms(200);
 173   2          }
 174   1          P0=0xFF; P1=0xFF; P2=0xFF; P3=0xFF;
C51 COMPILER V9.60.7.0   MAIN                                                              04/10/2025 14:14:19 PAGE 4   

 175   1      }
 176          
 177          //心跳效果（快速闪烁三次）
 178          void heartbeat(void) {
 179   1        uchar i;
 180   1          for(i=0; i<3; i++) {
 181   2              P0=0x00; P1=0x00; P2=0x00; P3=0x00;
 182   2              Delay_ms(200);
 183   2              P0=0xFF; P1=0xFF; P2=0xFF; P3=0xFF;
 184   2              Delay_ms(200);
 185   2          }
 186   1      }
 187          
 188          //波浪效果（从中心向四周扩散）
 189          void wave_effect(void) {
 190   1          uchar i;
 191   1          for(i=0; i<4; i++){
 192   2              P0 = ~(0x18 >> i);  // 00011000 右移
 193   2              P1 = ~(0x18 >> i);
 194   2              P2 = ~(0x18 << i);  // 00011000 左移
 195   2              P3 = ~(0x18 << i);
 196   2              Delay_ms(120);
 197   2          }
 198   1          P0=0xFF;P1=0xFF;P2=0xFF;P3=0xFF;
 199   1      }
 200          
 201          //跑马灯效果（四端口循环追逐）
 202          void marquee(void) {
 203   1          uchar i;
 204   1          for(i=0; i<8; i++){
 205   2              P0 = ~(0x80 >> i); 
 206   2              P1 = ~(0x80 >> (i+2)%8);
 207   2              P2 = ~(0x80 >> (i+4)%8);
 208   2              P3 = ~(0x80 >> (i+6)%8);
 209   2              Delay_ms(150);
 210   2          }
 211   1      }
 212          
 213          //渐变闪烁（不同频率闪烁）
 214          void gradient_blink(void) {
 215   1          uchar i;
 216   1          for(i=0; i<6; i++){
 217   2              P0=0x00;P1=0xFF;P2=0x00;P3=0xFF;
 218   2              Delay_ms(100 + i*20);
 219   2              P0=0xFF;P1=0x00;P2=0xFF;P3=0x00;
 220   2              Delay_ms(100 + i*20);
 221   2          }
 222   1      }
 223          
 224          //螺旋效果（内外交替旋转）
 225          void spiral(void) {
 226   1          uchar patterns[] = {0x7E,0xBD,0xDB,0xE7};
 227   1        uchar i;
 228   1          for(i=0; i<4; i++){
 229   2              P0 = patterns[i];
 230   2              P1 = patterns[(i+1)%4];
 231   2              P2 = patterns[(i+2)%4];
 232   2              P3 = patterns[(i+3)%4];
 233   2              Delay_ms(200);
 234   2          }
 235   1          P0=0xFF;P1=0xFF;P2=0xFF;P3=0xFF;
 236   1      }
C51 COMPILER V9.60.7.0   MAIN                                                              04/10/2025 14:14:19 PAGE 5   

 237          
 238          //彩虹渐变效果（简单的颜色变化）
 239          void rainbow_effect(void) {
 240   1          uchar patterns[] = {0xFF, 0x0C, 0xF3, 0x7E, 0x9F, 0x3F};
 241   1          uchar i;
 242   1          for(i=0; i<6; i++){
 243   2              P0 = patterns[i];
 244   2              P1 = patterns[(i+1)%6];
 245   2              P2 = patterns[(i+2)%6];
 246   2              P3 = patterns[(i+3)%6];
 247   2              Delay_ms(150);
 248   2          }
 249   1          P0=0xFF;P1=0xFF;P2=0xFF;P3=0xFF;
 250   1      }
 251          
 252          //闪烁中心点效果（四个端口的中间LED依次闪烁）
 253          void flash_center(void) {
 254   1          uchar i;
 255   1          for(i=0; i<3; i++){
 256   2              P0=0x80; P1=0x00; P2=0x00; P3=0x00;
 257   2              Delay_ms(200);
 258   2              P0=0x00; P1=0x80; P2=0x00; P3=0x00;
 259   2              Delay_ms(200);
 260   2              P0=0x00; P1=0x00; P2=0x80; P3=0x00;
 261   2              Delay_ms(200);
 262   2              P0=0x00; P1=0x00; P2=0x00; P3=0x80;
 263   2              Delay_ms(200);
 264   2          }
 265   1          P0=0xFF;P1=0xFF;P2=0xFF;P3=0xFF;
 266   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1662    ----
   CONSTANT SIZE    =     10    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      12
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
